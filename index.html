<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Baby Shower</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
</head>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Inicializa EmailJS
        emailjs.init("9whPqkgqidvtcME3T");
        console.log("EmailJS inicializado");

        const sendBtn = document.getElementById('send-message-btn');
        if (sendBtn) {
            sendBtn.addEventListener('click', () => {
                const buyerName = document.getElementById('buyer-name').value;
                const message = document.getElementById('custom-message').value;

                if (!buyerName || !message) {
                    alert("Por favor, completa todos los campos.");
                    return;
                }

                const selectedItems = Array.from(itemsContainer.querySelectorAll('input[type="checkbox"]'))
                    .filter(box => box.checked)
                    .map(box => box.parentElement.textContent.trim());

                const giftAmount = parseInt(giftInput.value) || 0;
                const total = totalDisplay.innerText;

                const emailParams = {
                    service_id: 'service_ipajrpn',
                    template_id: 'template_z3vjahc',
                    user_id: '9whPqkgqidvtcME3T',
                    template_params: {
                        buyer_name: buyerName,
                        selected_items: selectedItems.join(", "),
                        total: total,
                        custom_message: message,
                        gift_amount: giftAmount
                    }
                };

                fetch('https://api.emailjs.com/api/v1.0/email/send', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(emailParams)
                })
                .then(response => {
                    if (response.ok) {
                        alert('¬°Correo enviado exitosamente!');
                    } else {
                        return response.json().then(error => {
                            throw new Error(error.text);
                        });
                    }
                })
                .catch(error => {
                    console.error('Error al enviar el correo:', error);
                    alert('Hubo un error al enviar el correo. Revisa los detalles en la consola.');
                });
            });
        } else {
            console.error("Bot√≥n de env√≠o no encontrado.");
        }

        console.log("DOM completamente cargado");
    });
</script>
    
<body>

    <!-- Video Section -->
    <section id="video-section">
        <iframe src="https://drive.google.com/file/d/1Qo2h_K5FdMVg5-VtpZ-a8Z3DE4TPM2YT/preview"
        width="640" height="480" allow="autoplay; encrypted-media; picture-in-picture" allowfullscreen></iframe>
        <button id="continue-btn">Continuar</button>
    </section>

    <!-- Main Content Section (Hidden initially) -->
    <section id="main-content" style="display:none;">
        <h1>Pronto llegar√° nuestro peque√±o Jean Pierre...</h1>
            <p>¬°Estamos muy emocionados por su llegada! Si desean acompa√±arnos en este momento tan especial, hemos preparado una lista de deseos donde pueden colaborar con un peque√±o regalito para ayudarnos a prepararnos para su llegada. </p>
            <p>¬°Gracias por ser parte de este acontecimiento tan importante para nosotros!</p>
            <h5>Elige los art√≠culos que quisieras regalar, y al final ver√°s el total. Por favor, realiza el dep√≥sito en la cuenta indicada. No olvides incluir tu nombre y un mensaje especial al final de la p√°gina. ¬°Nos encantar√≠a leerlo! ü•∞</h5>
        <!-- Items Selection -->
        <div class="items"></div>
        <div class="item">
            <img src="assets/gift.png" alt="Gift" class="item-image">
            <label>
                Gift<input type="number" id="gift-amount" min="0" value="0"> 
                <div class="price">PEN</div>
            </label>
        </div>

        <!-- Total and Payment Info -->
        <div class="total-section">
            <h2>Total: <span id="total">0</span> PEN</h2>
            <p>N√∫mero de cuenta BCP Soles: <strong>19101973366097</strong></p>
            <p>N√∫mero de cuenta interbancaria: <strong>00219110197336609750</strong></p>
            <p>Las cuentas estan a nombre de mi hermanita Adrianaü•∞</p>
        </div>

        <!-- Message Section -->
        <div class="message-section">
            <h3>Escribe un mensaje para los papitos:</h3>
            <input type="text" id="buyer-name" placeholder="Tu nombre">
            <textarea id="custom-message" placeholder="Escribe un mensaje..."></textarea>
            <button id="send-message-btn">Enviar Mensaje</button>
        </div>
    </section>
    <script src="script.js"></script>

</body>
</html>
